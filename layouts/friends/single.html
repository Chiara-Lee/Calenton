{{define "body"}}
<div class="page-header">
    <h1 class="page-title">友人帐</h1>
    <h2 class="page-subtitle" style="font-family: 'Playwrite MX Guides', serif;">Would you like to write down your name? If you’re willing, there’s a place reserved here just for you.</h2>
</div>

<div class="card-container">
    <div class="styled-card">
        <div class="styled-card-header">
            <img src="/image/favicon.png" alt="头像">
            <div class="styled-card-content">
                <h3>空泡编号：5D-19</h3>
                <p><strong>发布者：</strong> 广播员///</p>
                <p><strong>特征向量：</strong> ☰☰☰☰</p>
            </div>
        </div>
        <p class="full-width-text">
            空泡居民请注意！空泡周边出现高浓度生物质翻涌，请立即疏散至400米外区域。SCP基金会士指挥部将派遣机组尽快出动反应小组以排查危险区域。
        </p>
    </div>

    <div class="styled-card">
        <div class="styled-card-header">
            <img src="/image/favicon.png" alt="头像">
            <div class="styled-card-content">
                <h3>空泡编号：5D-19</h3>
                <p><strong>发布者：</strong> 广播员///</p>
                <p><strong>特征向量：</strong> ☰☰☰☰</p>
            </div>
        </div>
        <p class="full-width-text">
            在节点矩阵尚未建立的时期，一切语义流的传输都因非物质的阻隔而变得无比艰难。在我们的管理之下，绝大多数空泡都遵循着一样的方针：持续监控空泡周边非物质的状况，并定期进行语义流广播。时至今日，包裹地球的非物质事实上并没有多大的变化，语义流漫漶率一直平均维持在95%以上的水平。可以想见，那个时期的语义流广播，几乎可以说就是在撞运气：通过持续不断的高强度广播，来祈祷有一些只言片语，有一些零星碎片，有一些心意和援助，能抵住非物质的侵扰，顺利到达目标空泡。

有的时候，依赖一些奇迹般的微小窗口，我们也能成功地将一些语义流——甚至是人类个体这样复杂的语义流——较为完整地送达目标空泡。在那个黑暗的时期，在那个艰难的时刻，有相当多的人冒着生命危险，抵住漫漶，将各种消息传播到了各个空泡。尽管这样的机会稀疏得宛如空中浮尘，但就是在那样的一次次微小的交流里，我们开始看到了希望。

当然，这其中最重要的，还是我们发现了那从非物质中析出的不明金属，也就是我们今日所称的：稀金。
        </p>
    </div>

    <div class="styled-card">
        <div class="styled-card-header">
            <img src="/image/favicon.png" alt="头像">
            <div class="styled-card-content">
                <h3>空泡编号：5D-19</h3>
                <p><strong>发布者：</strong> 广播员///</p>
                <p><strong>特征向量：</strong> ☰☰☰☰</p>
            </div>
        </div>
        <p class="full-width-text">
            我们今天接收到了相信是来自空泡A3-KA的语义流广播，漫漶率为98.24%。从中我们勉强分析出了下面这段信息：

            “致[漫漶不可辨]此广播[漫漶不可辨]3-KA，[漫漶不可辨]们的食物[漫漶不可辨]足，但是在基础金[漫漶不可辨]巨大的问题。目前空泡内共二[漫漶不可辨]长期修理状[漫漶不可辨]多久，如果持续[漫漶不可辨]问题。我们希望[漫漶不可辨]余的空泡能够帮助我们[漫漶不可辨]理。我们[漫漶不可辨]吨银[漫漶不可辨]0吨[漫漶不可辨]金。目前我们还未[漫漶不可辨]急状态，所以运输可以在非[漫漶不可辨]再进行，但我们仍希望能够尽[漫漶不可辨]泡一切安好，以下为信息的重复广播——”
            
            我们大致推断空泡A3-KA需要基础金属的补充，但具体的数目因为漫漶而无法辨识，我们也不知道情况是否紧急。无论如何，我们空泡的基础金属储备充足，可以承担运输漫漶的风险。我们应该假定我们的同胞处于紧急状态，及时伸出援手。
            
            我们将观察未来三个标准月的非物质环境，并将每种分别50吨的基础金属向空泡A3-KA进行语义流传输。哪怕这仅仅是我们瞎担心，希望空泡A3-KA一切安好，能顺利渡过难关。
        </p>
    </div>


  <!-- 卡片创建入口 -->
  <div class="card-entry">
    <div class="dashed-border">
      <span class="plus-sign">+</span>
    </div>
  </div>
</div>

<!-- 卡片呼出模态框 -->
<div class="modal-overlay" id="modal-overlay">
    <div class="styled-card modal-card">
        <!-- 关闭按钮 -->
        <button class="close-modal-button" id="close-modal-button">&times;</button>
        <div class="styled-card-header">
            <!-- 点击头像区域上传图片 -->
            <label for="avatar-upload" class="avatar-upload-label">
                <img src="/image/favicon.png" alt="头像" id="avatar-preview">
                <input type="file" id="avatar-upload" accept="image/*" style="display: none;">
            </label>
            <div class="styled-card-content">
                <h3>空泡编号：</h3>
                <input type="text" id="bubble-number" placeholder="输入气泡编号">
                <p><strong>发布者：</strong> <input type="text" id="publisher" placeholder="输入发布者"></p>
                <p><strong>特征向量：</strong> <input type="text" id="feature-vector" placeholder="输入特征向量"></p>
            </div>
        </div>
        <p class="full-width-text">
            <textarea id="card-description" rows="4" placeholder="输入卡片详细内容..."></textarea>
        </p>
        <button id="save-card-button">保存</button>
    </div>
</div>



</div>

<script>
    // 获取相关元素
    const cardEntry = document.querySelector('.card-entry');
    const newCardModal = document.getElementById('modal-overlay');
    const saveCardButton = document.getElementById('save-card-button');
    const cardContainer = document.querySelector('.card-container');
    const avatarUploadInput = document.getElementById('avatar-upload');
    const avatarPreview = document.getElementById('avatar-preview');
    
    // 点击卡片创建入口时显示模态框
    cardEntry.addEventListener('click', () => {
        newCardModal.style.display = 'flex';
    });
    
    // 用户点击保存按钮时，隐藏模态框并添加新卡片
    saveCardButton.addEventListener('click', (event) => {
        event.preventDefault();
    
        // 获取表单中的值
        const bubbleNumber = document.getElementById('bubble-number').value;
        const publisher = document.getElementById('publisher').value;
        const featureVector = document.getElementById('feature-vector').value;
        const description = document.getElementById('card-description').value;
        const avatarSrc = avatarPreview.src; // 获取头像路径
    
        // 创建新的卡片
        const newCard = document.createElement('div');
        newCard.classList.add('styled-card');
        newCard.innerHTML = `
            <div class="styled-card-header">
                <img src="${avatarSrc}" alt="头像">
                <div class="styled-card-content">
                    <h3>空泡编号：${bubbleNumber}</h3>
                    <p><strong>发布者：</strong> ${publisher}</p>
                    <p><strong>特征向量：</strong> ${featureVector}</p>
                </div>
            </div>
            <p class="full-width-text">${description}</p>
        `;
    
        // 替换卡片创建入口的位置
        cardContainer.replaceChild(newCard, cardEntry);
    
        // 重新创建一个新的入口卡片并添加到容器末尾
        const newEntry = document.createElement('div');
        newEntry.classList.add('card-entry');
        newEntry.innerHTML = `
            <div class="dashed-border">
                <span class="plus-sign">+</span>
            </div>
        `;
    
        // 绑定新入口卡片的点击事件
        newEntry.addEventListener('click', () => {
            newCardModal.style.display = 'flex';
        });
    
        // 添加新的入口卡片到容器末尾
        cardContainer.appendChild(newEntry);
    
        // 隐藏模态框
        newCardModal.style.display = 'none';
    
        // 清空输入框和恢复默认头像
        document.getElementById('bubble-number').value = '';
        document.getElementById('publisher').value = '';
        document.getElementById('feature-vector').value = '';
        document.getElementById('card-description').value = '';
        avatarPreview.src = "/image/avatar/yuriri.jpg";
    });
    
    // 点击模态框之外的区域时关闭模态框
    newCardModal.addEventListener('click', (event) => {
        const modalContent = newCardModal.querySelector('.modal-card');
        if (!modalContent.contains(event.target)) {
            newCardModal.style.display = 'none';
        }
    });
    
    // 点击退出按钮关闭模态框
    document.getElementById('close-modal-button').addEventListener('click', () => {
        newCardModal.style.display = 'none';
    });
    
    // 添加文件上传事件监听器
    avatarUploadInput.addEventListener('change', (event) => {
        const file = event.target.files[0];
        if (file && file.type.startsWith('image/')) {
            const reader = new FileReader();
            reader.onload = (e) => {
                avatarPreview.src = e.target.result; // 设置图片预览
            };
            reader.readAsDataURL(file);
        } else {
            alert("请选择图片文件！");
        }
    });
    </script>
  

{{end}}
